More Data:
1) –î–≤–∏–≥–∞—Ç–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
2) –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç–Ω–∏–∫ (—Ä–∞–∑–≥–æ–Ω 10-40–ì—Ü)
3) –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º —á–∞—Å—Ç–æ—Ç–Ω–∏–∫–µ, –∑–∞—Ç–µ–º –≤—ã–∫–ª—é—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç–Ω–∏–∫ (10-40–ì—Ü)
4) –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º —á–∞—Å—Ç–æ—Ç–Ω–∏–∫–µ, –¥–æ–±–∞–≤–∏—Ç—å –º–æ–º–µ–Ω—Ç –Ω–∞–≥—Ä—É–∑–∫–∏

ML PIPELINE

Before:
1) Data Preprocess
1.1) collectMetadata(path) -> Table with metadata about files in dataset
1.2) getDataset(metadataTable, datasetName) -> Filtered metadata table by labels, type of signal etc.
1.3) inspectSignal(signal, Fs, titleStr) -> plot in time, freq domains
1.4) getWindowData(files, windowRef, Fs) -> extracted window data and timestamps of signal by windowRef cell
for example {16.50 - 17.50 s", 1}.

2) Features Extractions
2.1) extractSignalFeatures(signal, Fs) -> array with time and freq domain features of 1d array signal
2.2) extractCurrentFeatures(data, Fs) -> calls extractSignalFeatures and add cross phases features to array
2.3) extractCurrentFeaturesTable(data, Fs) -> calls extractSignalFeatures and returns features array and
features table (for inspection)
2.4) excludeFeatures(X, featuresTables, featuresToRemove) -> remove features from feature matrix and features table
by names
2.5) generateCurrentFeaturesFromFiles(files, windowDuration, overlapPercent, emptyFlag)
-> extract phase current features, returns X,Y - for ML algos, featureTables - for inspection, featureNames - additional
Also can return empty features table. Calls almost every functions written before. Just disaster...
2.6) getCachedFeatures(files, datasetName, windowDuration, overlapPercent, force)
-> same as generateCurrentFeaturesFromFiles but with caching options

Now (in progress):
Modules:
1) +io
1.1) io.readRaw (return array from file)
1.2) io.readCurrent (use io.readRaw and do some offseting adc values)
1.3) io.readVibro (not implemented yet)
2) +metadata
2.1) metadata.collect (same as collectMetadata)
2.2) metadata.filter
2.3) metadata.selectPreset (same as getDataset, use metadata.filter)
--------------
3) +preprocess
3.1) windows
Splits signal into overlapping time windows.
[windows, timeIntervals] = windows(data, fs, duration, overlap)
4) +features
4.1) features.extractBasic(signal, Fs)
Time and frequency domain features of a single 1D signal.
Equivalent to your extractSignalFeatures.
4.2) features.extractPhaseCurrents(phaseSignals, Fs)
Handles 3-phase current or multi-channel signals.
Internally calls extractBasic on each channel.
Adds cross-phase features (e.g., phase diff, correlation).
Refactored version of extractCurrentFeatures.
4.3) features.fromSignalTable(signalTable)
Accepts a table with signals and metadata.
Returns: X (feature matrix), featureNames, optionally featureTable for inspection. Replaces extractCurrentFeaturesTable.
4.4) features.exclude(X, featureNames, featuresToRemove)
Clean separation of feature filtering. Replaces excludeFeatures.
4.5) features.pipeline(files, fs, windowDuration, overlap, options)
Orchestrates: io.readX preprocess.windows
features.extractPhaseCurrents
Label assignment
Handles options like:
Return feature table or not
Apply exclusion list
Apply caching (via a wrapper or separate cache module)
Cleanly replaces generateCurrentFeaturesFromFiles.
4.6) features.cache(files, datasetName, settingsStruct)
Thin wrapper around features.pipeline
Adds caching logic
Replaces getCachedFeatures


Enhancements ?
1) Feature Set Registries. Have a +features/registry.m or a features.getAvailableFeatures() that returns available/registered feature extractors. Allows dynamic usage or GUI-based selection.
2) Use a struct or class to pass feature selection, naming, and options. Makes pipeline more declarative:
config.timeFeatures = true;
config.freqFeatures = true;
config.crossPhase = false;
config.exclude = {'RMS', 'Kurtosis'};


+features
‚îú‚îÄ‚îÄ extractBasic.m
‚îú‚îÄ‚îÄ extractEnsemble.m
‚îú‚îÄ‚îÄ extractCurrent.m
‚îú‚îÄ‚îÄ extractVibration.m
‚îú‚îÄ‚îÄ extractCombined.m
‚îú‚îÄ‚îÄ fromSignalTable.m
‚îú‚îÄ‚îÄ exclude.m
‚îú‚îÄ‚îÄ pipeline.m
‚îú‚îÄ‚îÄ cache.m
‚îî‚îÄ‚îÄ registry.m (optional)


–û—á–µ–Ω—å –ø–æ–Ω–∏–º–∞—é —Ç–µ–±—è ‚Äî —Ç—ã –Ω–∞ —Ç–æ–π —Å—Ç–∞–¥–∏–∏, –∫–æ–≥–¥–∞ –≤—Å—ë –≤—Ä–æ–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å:
¬´–ê –≤ —á—ë–º —Ç—É—Ç –Ω–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞? –ß—Ç–æ —è –º–æ–≥—É –≤–Ω–µ—Å—Ç–∏ –Ω–æ–≤–æ–≥–æ, –∫—Ä–æ–º–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤?¬ª

–ü–æ–∑–≤–æ–ª—å, —è –ø–æ–ø—Ä–æ–±—É—é —Ç–µ–±–µ –ø–æ–º–æ—á—å –Ω–µ–º–Ω–æ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é –∏ –Ω–∞–∫–∏–¥–∞—Ç—å –∏–¥–µ–∏, –∫—É–¥–∞ –º–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è.

üß† –ß—Ç–æ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å (–∏ —ç—Ç–æ –∫—Ä—É—Ç–æ):
–ß—ë—Ç–∫–∏–π —Å–±–æ—Ä –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ (—Ç–æ–∫, –≤–∏–±—Ä–∞—Ü–∏—è)
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º, —á–∞—Å—Ç–æ—Ç–∞–º, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º
–≠–∫—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (time/freq domain)
–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é Random Forest, KNN –∏ —Ç.–¥.
–¢—ã –ø–æ—Å—Ç—Ä–æ–∏–ª —Ä–∞–±–æ—á–∏–π –ø–∞–π–ø–ª–∞–π–Ω, –∏ —ç—Ç–æ —É–∂–µ –±–∞–∑–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è.

üéØ –ì–¥–µ –∏—Å–∫–∞—Ç—å –Ω–∞—É—á–Ω—É—é –Ω–æ–≤–∏–∑–Ω—É?
–ù–∏–∂–µ ‚Äî –∏–¥–µ–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∑–∞ —Ä–∞–º–∫–∏ "–ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä".

1. –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π (domain adaptation / transfer learning)
üìå –ü—Ä–æ–±–ª–µ–º–∞: –æ–±—É—á–∏–ª—Å—è –Ω–∞ 10‚ÄØHz, –∞ –Ω–∞ 30‚ÄØHz –º–æ–¥–µ–ª—å —É–∂–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ.

–ú–æ–∂–Ω–æ –ª–∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, —É—Å—Ç–æ–π—á–∏–≤—É—é –∫ —á–∞—Å—Ç–æ—Ç–µ –≤—Ä–∞—â–µ–Ω–∏—è, –Ω–∞–≥—Ä—É–∑–∫–µ, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ç.–¥.?
–≠—Ç–æ –Ω–æ–≤–∏–∑–Ω–∞: ¬´–û–±–æ–±—â–∞—é—â–∞—è –º–æ–¥–µ–ª—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π —Ä–∞–±–æ—Ç—ã¬ª.
–ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:

Domain adaptation (–Ω–∞–ø—Ä–∏–º–µ—Ä, CORAL, TCA)
Normalization techniques (e.g., feature-wise z-score per group)
Use frequency-invariant features (e.g., envelope spectrum)
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (feature learning)
–í–º–µ—Å—Ç–æ —Ä—É—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:

Autoencoder'—ã
TSFRESH (–≤ Python) ‚Äî —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä —Ñ–∏—á —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–±–æ—Ä–æ–º
Feature selection + interpretability (–Ω–∞–ø—Ä–∏–º–µ—Ä, SHAP)
–ù–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ö—É–∂–µ (–∏–ª–∏ –ª—É—á—à–µ), —á–µ–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä—É—á–Ω–æ–π.

3. –ú—É–ª—å—Ç–∏—Å–µ–Ω—Å–æ—Ä–Ω—ã–π —Ñ—å—é–∂–Ω
–£ —Ç–µ–±—è –µ—Å—Ç—å —Ç–æ–∫ –∏ –≤–∏–±—Ä–∞—Ü–∏—è ‚Äî –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å:

–¢–æ–ª—å–∫–æ —Ç–æ–∫
–¢–æ–ª—å–∫–æ –≤–∏–±—Ä–∞—Ü–∏—è
–û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
–í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–æ–≤–∏–∑–Ω—ã:

–ö–∞–∫–æ–π —Å–∏–≥–Ω–∞–ª –¥–∞—ë—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?
–ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫ –∫–∞–∫ –∑–∞–º–µ–Ω—É –≤–∏–±—Ä–∞—Ü–∏–∏?
–ö–∞–∫–æ–π —Ç–∏–ø —Ñ–∏—á–µ–π (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ, —á–∞—Å—Ç–æ—Ç–Ω—ã–µ) –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞?
4. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
–†–∞–∑ —É —Ç–µ–±—è –µ—Å—Ç—å –æ–∫–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞ ‚Äî –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏:

1D-CNN
RNN / LSTM
Temporal convolutional networks (TCN)
–ù–æ–≤–∏–∑–Ω–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∏–≥–Ω–∞–ª–æ–≤, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (mean, rms –∏ —Ç.–¥.)

5. –û–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å (Explainable ML)
–î–∞–∂–µ –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Random Forest ‚Äî –º–æ–∂–Ω–æ –ø–æ–π—Ç–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏:

–ö–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤–∞–∂–Ω—ã?
–î–ª—è –∫–∞–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤ –æ–Ω–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã?
–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –æ–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –¥—Ä—É–≥–æ–µ
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: SHAP, permutation importance, partial dependence plots

6. –§–∏–∑–∏–∫–∞-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
–ü–æ–ø—Ä–æ–±—É–π –≤—ã—Ç–∞—â–∏—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –∞ —á—Ç–æ-—Ç–æ, —á—Ç–æ –∏–º–µ–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤ –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –º–∞—à–∏–Ω:

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–æ–∫–∞ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–∞—Ö (–Ω–∞–ø—Ä., –≥–∞—Ä–º–æ–Ω–∏–∫–∏)
Envelope spectrum
Order tracking
Fault frequency matching
üß∞ –ß—Ç–æ —Ç—ã –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:
–ò–¥–µ—è	–ß—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
‚öôÔ∏è –ú—É–ª—å—Ç–∏—Å–µ–Ω—Å–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑	–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ç–æ–∫–∞ + –≤–∏–±—Ä–∞—Ü–∏–∏
üìê –§—å—é—á–µ—Ä —Å–µ–ª–µ–∫—à–Ω	–ò–∑—É—á–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–∏–º–µ–Ω–∏—Ç—å SHAP
üß¨ –ê–≤—Ç–æ—Ñ–∏—á–∏	–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å TSFRESH –∏–ª–∏ PCA
üîÅ –û–±–æ–±—â–µ–Ω–∏–µ	–û–±—É—á–∏—Ç—å –Ω–∞ 10‚ÄØHz, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 30‚ÄØHz
üß† –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è	–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á—ë—Ç: –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –∫–∞–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤
üí° –í–∞–∂–Ω–æ
–ù–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞ ‚Äî —ç—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º.
–ß–∞—Å—Ç–æ —ç—Ç–æ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–∑–≤–µ—Å—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä:

–ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
–ù–æ–≤–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (—Ç–æ–∫ + –≤–∏–±—Ä–∞—Ü–∏—è)
–ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
–ö—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
ü§ù –ú–æ–≥—É –ø–æ–º–æ—á—å —Å:
–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–æ–π –≥–∏–ø–æ—Ç–µ–∑
–û—Ü–µ–Ω–∫–æ–π –Ω–æ–≤–∏–∑–Ω—ã
–ü–æ–∏—Å–∫–æ–º —Å—Ç–∞—Ç–µ–π –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–æ–≤
–ì–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è —Å—Ç–∞—Ç—å–∏ üòÑ


–û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å cross-validation! –≠—Ç–æ —É–∂–µ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–µ—Ä—å—ë–∑–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ üí™
–ù–æ –≤–æ—Ç —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, —á—Ç–æ –æ–∫–Ω–∞ –ø–æ 1‚ÄØ—Å —Å 50% –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –¥–µ—Ç–∞–ª—å, –∫–æ—Ç–æ—Ä–∞—è, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∏ –æ–±—ä—è—Å–Ω—è–µ—Ç ‚Äú–≤–æ–ª—à–µ–±–Ω—ã–µ‚Äù 98% —Ç–æ—á–Ω–æ—Å—Ç–∏.

‚ö†Ô∏è –ü–æ—á–µ–º—É –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –æ–∫–æ–Ω –º–æ–∂–µ—Ç –∑–∞–≤—ã—à–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å
–ö–æ–≥–¥–∞ —Ç—ã —Ä–µ–∂–µ—à—å —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ–∫–Ω–∞ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ 1‚ÄØ—Å –∏ 50%, —É —Ç–µ–±—è –ø–æ–ª—É—á–∞—é—Ç—Å—è —Ç–∞–∫–∏–µ –æ–∫–Ω–∞:


[0.0 ‚Äì 1.0 —Å–µ–∫]  
[0.5 ‚Äì 1.5 —Å–µ–∫]  
[1.0 ‚Äì 2.0 —Å–µ–∫]  
...
–¢–æ –µ—Å—Ç—å —Å–æ—Å–µ–¥–Ω–∏–µ –æ–∫–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —á–∞—Å—Ç—å –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö.

‚ùó –ü—Ä–æ–±–ª–µ–º–∞:
–ï—Å–ª–∏ —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –æ–∫–Ω–∞ –ø–æ–ø–∞–¥–∞—é—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–µ, –∏ –≤ —Ç–µ—Å—Ç, –º–æ–¥–µ–ª—å –ø–æ —Å—É—Ç–∏ –≤–∏–¥–∏—Ç –∑–Ω–∞–∫–æ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∏ —ç—Ç–æ:

–ù–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –æ–±–æ–±—â–µ–Ω–∏—é
–ó–∞–≤—ã—à–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (—Ç–æ—á–Ω–æ—Å—Ç—å, F1 –∏ —Ç.–¥.)
‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å?
1. Cross-validation –ø–æ —Ñ–∞–π–ª–∞–º (–∏–ª–∏ –ø–æ —Å–µ—Å—Å–∏—è–º)
–í–º–µ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è –ø–æ –æ–∫–Ω–∞–º, —Å–¥–µ–ª–∞–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º / —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º.

–ü—Ä–∏–º–µ—Ä:


cv = cvpartition(fileIDs, 'KFold', 5);
–¢–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–¥–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤, –∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è ‚Äî –Ω–∞ –¥—Ä—É–≥–∏—Ö, –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è.

2. –û–∫–Ω–∞ –±–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è
–î–ª—è —á–∏—Å—Ç–æ—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –ø–æ–ø—Ä–æ–±—É–π —Ç–∞–∫–∂–µ –æ–∫–Ω–∞ –±–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è:

–ù–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 1‚ÄØ—Å –±–µ–∑ –Ω–∞–ª–æ–∂–µ–Ω–∏—è
–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –æ–∫–Ω–æ –Ω–∞ —Ñ–∞–π–ª (–¥–ª—è baseline)
3. –û—Ü–µ–Ω–∫–∞ –ø–æ ‚Äú–∂—ë—Å—Ç–∫–∏–º‚Äù —É—Å–ª–æ–≤–∏—è–º
–ü–æ–ø—Ä–æ–±—É–π:

–û–±—É—á–∏—Ç—å –Ω–∞ 10‚ÄØHz, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 30‚ÄØHz
–û–±—É—á–∏—Ç—å –Ω–∞ ‚Äú–±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏‚Äù, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ ‚Äú—Å —Ç–æ—Ä–º–æ–∑–æ–º‚Äù
–û–±—É—á–∏—Ç—å –Ω–∞ ‚Äú—Ç–æ–∫‚Äù, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ ‚Äú–≤–∏–±—Ä–∞—Ü–∏—é‚Äù
üß† –ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å?
–ß–µ—Å—Ç–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –æ–±–æ–±—â–∞–µ—Ç
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞—Ç—å –≤ —Å—Ç–∞—Ç—å–µ:
‚Äú–ü—Ä–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π CV —Ç–æ—á–Ω–æ—Å—Ç—å 98%, –Ω–æ –ø—Ä–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –ø–æ —Ñ–∞–π–ª–∞–º ‚Äî 85%, –∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ –º–µ–∂–¥—É —á–∞—Å—Ç–æ—Ç–∞–º–∏ ‚Äî 70%‚Äù

üëâ –≠—Ç–æ —É–∂–µ –Ω–∞—É—á–Ω—ã–π –≤–∫–ª–∞–¥: —Ç—ã –ø–æ–∫–∞–∑–∞–ª –≤–ª–∏—è–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –æ—Ü–µ–Ω–∫–∏ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

üìå –í—ã–≤–æ–¥
–ï—Å—Ç—å	–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
Cross-val –ø–æ –æ–∫–Ω–∞–º	Cross-val –ø–æ —Ñ–∞–π–ª–∞–º
–û–∫–Ω–∞ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º	–ë–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è / –æ–¥–Ω–æ –æ–∫–Ω–æ
–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å	–û–±—â–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–±–æ–±—â–∞—Ç—å
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–º–æ—á—å:

–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è GroupKFold –ø–æ —Ñ–∞–π–ª–∞–º/—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º
–°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –¥–ª—è —Å—Ç–∞—Ç—å–∏
–ü–æ—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å, –∫–∞–∫ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
–¢—ã —Å–µ–π—á–∞—Å –Ω–∞ –≤–∞–∂–Ω–æ–º —ç—Ç–∞–ø–µ ‚Äî —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –≥–¥–µ ‚Äú–º–∞–≥–∏—è‚Äù, –∞ –≥–¥–µ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ò —Ç—ã —É–∂–µ –±–ª–∏–∑–∫–æ üòâ
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –Ω–∞–ø–∏—à–∏, –≤ –∫–∞–∫–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ –≤—Å–µ–≥–æ –∫–æ–ø–∞—Ç—å, –∏ —è –ø–æ–º–æ–≥—É –ø—Ä–∏–¥—É–º–∞—Ç—å, –∫–∞–∫ —Ç—É–¥–∞ –≥—Ä–∞–º–æ—Ç–Ω–æ –∑–∞–π—Ç–∏ —Å –Ω–∞—É—á–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.


–ü–æ–Ω–∏–º–∞—é —Ç–µ–±—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ.
–ö–æ–≥–¥–∞ Random Forest –¥–∞—ë—Ç 98% —Ç–æ—á–Ω–æ—Å—Ç–∏ ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –Ω–µ —Ä–∞–¥–æ—Å—Ç—å, –∞ —Ç—Ä–µ–≤–æ–≥—É –∏ –æ—â—É—â–µ–Ω–∏–µ, —á—Ç–æ ‚Äú–Ω–µ—á–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å‚Äù.

–ù–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –Ω–µ –ø–µ—á–∞–ª—å, –∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–ø–Ω—É—Ç—å –≥–ª—É–±–∂–µ. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è –≤–º–µ—Å—Ç–µ.

üîç –ü–æ—á–µ–º—É –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –Ω–µ –ø–æ–≤–æ–¥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è?
1. –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è (overfitting)
–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –∫–ª–∞—Å—Å—ã –ª–µ–≥–∫–æ —Ä–∞–∑–ª–∏—á–∏–º—ã, RF –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω—ã.
–û—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —É —Ç–µ–±—è:
–û–∫–Ω–∞ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏
–ú–Ω–æ–≥–æ –ø–æ—Ö–æ–∂–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏ –∏ —Ç–µ—Å—Ç–µ
–ò–ª–∏ –¥–∞–∂–µ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ñ–∞–π–ª—ã, –Ω–æ —Ä–∞–∑–Ω—ã–µ –∫—É—Å–∫–∏ ‚Üí —ç—Ç–æ data leakage
–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ train/test –∏–¥—ë—Ç –ø–æ —Ñ–∞–π–ª–∞–º, –∞ –Ω–µ –ø–æ –æ–∫–Ω–∞–º
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç–æ—Ç–∞—Ö / –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö, –≥–¥–µ –æ–Ω–∞ –Ω–µ –æ–±—É—á–∞–ª–∞—Å—å
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cross-validation –ø–æ –≥—Ä—É–ø–ø–∞–º, –Ω–∞–ø—Ä–∏–º–µ—Ä GroupKFold (–µ—Å–ª–∏ –≤ MATLAB ‚Äî –≤—Ä—É—á–Ω—É—é)
2. 98% ‚Äî —ç—Ç–æ –Ω–µ –æ—Ç–≤–µ—Ç, –∞ –≤–æ–ø—Ä–æ—Å: –ø–æ—á–µ–º—É —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ?
–ö–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–∞—é—Ç —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç?
–ü–æ—á–µ–º—É –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–Ω–æ —Ä–∞–∑–ª–∏—á–∞–µ—Ç –∫–ª–∞—Å—Å—ã?
–ú–æ–∂–µ—Ç –±—ã—Ç—å, –µ—Å—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ ‚Äú–≤—ã–¥–∞—é—Ç‚Äù –∫–ª–∞—Å—Å?
–ù–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ –∞–º–ø–ª–∏—Ç—É–¥—ã/—ç–Ω–µ—Ä–≥–∏–∏ ‚Üí —ç—Ç–æ –Ω–µ –ø—Ä–æ –¥–µ—Ñ–µ–∫—Ç, –∞ –ø—Ä–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –î–æ–±–∞–≤—å ‚Äú—Å–ª–æ–∂–Ω–æ—Å—Ç–∏‚Äù ‚Üí –ø—Ä–æ—è–≤–∏—Ç—Å—è –Ω–æ–≤–∏–∑–Ω–∞
–ï—Å–ª–∏ –º–æ–¥–µ–ª—å —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ ‚Äî —É—Å–ª–æ–∂–Ω–∏ –µ—ë:

–ö–∞–∫	–ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç
–û–±—É—á–∞—Ç—å –Ω–∞ 10‚ÄØHz, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 30‚ÄØHz	–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
–û–±—É—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ ‚Äú—Ç–æ–∫‚Äù, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ ‚Äú–≤–∏–±—Ä–∞—Ü–∏—é‚Äù	–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —É—Ö—É–¥—à–∏—Ç—å —Å–∏–≥–Ω–∞–ª (—à—É–º, –ø—Ä–æ–ø—É—Å–∫–∏)	–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
–°–¥–µ–ª–∞—Ç—å real-time –≤–∞—Ä–∏–∞–Ω—Ç (–æ–∫–Ω–∞ –ø–æ 0.1 —Å–µ–∫)	–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å
4. –°–¥–µ–ª–∞—Ç—å —à–∞–≥ –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ (explainability)
–í–æ–ø—Ä–æ—Å: –∞ –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–∞—é—Ç 98% —Ç–æ—á–Ω–æ—Å—Ç–∏?

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–∏–µ –∏–∑ –Ω–∏—Ö —Ä–µ–∞–ª—å–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã
–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É–±—Ä–∞—Ç—å ‚Äú—à—É–º–Ω—ã–µ‚Äù –ø—Ä–∏–∑–Ω–∞–∫–∏ ‚Äî —É–ø–∞–¥—ë—Ç –ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å?
üìå –≠—Ç–æ –∏ –µ—Å—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ!

5. –ù–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –≤—ã–≤–æ–¥–∞—Ö, –∞ –Ω–µ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏
–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–µ–º —Å–æ ‚Äú—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏‚Äù –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏:

¬´–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–æ–∫–æ–≤—ã—Ö –∏ –≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤¬ª
¬´–û—Ü–µ–Ω–∫–∞ –≤–ª–∏—è–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –≤—Ä–∞—â–µ–Ω–∏—è –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è¬ª
¬´–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –∑–∞–¥–∞—á–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è –ø–æ —Ç–æ–∫—É¬ª
üí° –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:
‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ—Å—Ç –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å –æ–±—É—á–µ–Ω–∏–µ–º (–ø–æ —Ñ–∞–π–ª–∞–º)
üìâ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É—Ö—É–¥—à–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (—à—É–º, –æ–±—Ä–µ–∑–∫–∞) ‚Üí —É–ø–∞–¥—ë—Ç –ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å?
üîÄ –ü–æ–º–µ–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ (—á–∞—Å—Ç–æ—Ç–∞, —Ç–∏–ø –¥–µ—Ñ–µ–∫—Ç–∞) ‚Üí –≤–Ω–µ –∑–æ–Ω—ã –æ–±—É—á–µ–Ω–∏—è
üìä –ü–æ—Å—Ç—Ä–æ–∏—Ç—å feature importance ‚Üí –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ ‚Äú—Ç–∞—â–∏—Ç‚Äù –º–æ–¥–µ–ª—å
üß† –ü–æ–¥—É–º–∞—Ç—å: –∞ –µ—Å–ª–∏ –±—ã —ç—Ç–æ –±—ã–ª–∞ —Ä–µ–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ?
üìå –ì–ª–∞–≤–Ω–æ–µ
–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ‚Äî –Ω–µ –∫–æ–Ω–µ—Ü –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∞ –µ–≥–æ –Ω–∞—á–∞–ª–æ.

–¢—ã –ø–æ—Å—Ç—Ä–æ–∏–ª –∫—Ä—É—Ç—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –±—ã—Ç—å:

–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ –Ω–æ–≤—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ:

–°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É
–ü—Ä–∏–¥—É–º–∞—Ç—å –ø–ª–∞–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
–ü—Ä–æ–ø–∏—Å–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞—É—á–Ω–æ–π —Å—Ç–∞—Ç—å–∏ –∏–ª–∏ –≥–ª–∞–≤—ã
–¢—ã —É–∂–µ –Ω–∞ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–µ–º —É—Ä–æ–≤–Ω–µ. –û—Å—Ç–∞–ª–æ—Å—å ‚Äî —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –æ—Ç ‚Äú—Ä–∞–±–æ—Ç–∞–µ—Ç‚Äù –∫ ‚Äú–ø–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫–∞–∫ —É–ª—É—á—à–∏—Ç—å‚Äù. –ò —ç—Ç–æ —É–∂–µ –Ω–∞—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ üí°üë®‚Äçüî¨

–•–æ—á–µ—à—å ‚Äî –º–æ–∂–µ–º –≤–º–µ—Å—Ç–µ –Ω–∞–∫–∏–¥–∞—Ç—å —Ç–µ–º—É –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç—å–∏.


–¢—ã –≤—Å—ë –¥–µ–ª–∞–µ—à—å –≥—Ä–∞–º–æ—Ç–Ω–æ ‚Äî —É —Ç–µ–±—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (feature importance) —Å –ø–æ–º–æ—â—å—é TreeBagger –∏ OOBPermutedPredictorDeltaError ‚Äî —ç—Ç–æ –æ—Ç–ª–∏—á–Ω–æ! üëè

–ù–æ –¥–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è —Å –≤–æ–∑–º–æ–∂–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã –≤—Å—ë –µ—â—ë –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ (98% –∏ —Ç.–ø.), –¥–∞–∂–µ –ø—Ä–∏ cvpartition.

üîç –í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: cvpartition(Y, 'KFold', K)
–ö–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å:


cv = cvpartition(Y, 'KFold', K);
...—Ç—ã –¥–µ–ª–∏—à—å –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º X –∏ Y, —Ç.–µ. –ø–æ –æ–∫–Ω–∞–º.

–ê –µ—Å–ª–∏ —Ç—ã –¥–µ–ª–∞–ª –æ–∫–Ω–∞ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º, —Ç–æ:

–°–æ—Å–µ–¥–Ω–∏–µ –æ–∫–Ω–∞ –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ —Ä–∞–∑–Ω—ã–µ folds (–æ–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç)
–≠—Ç–æ –≤–µ–¥—ë—Ç –∫ —É—Ç–µ—á–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (data leakage)
–ö–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ ‚Äî –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚úÖ –†–µ—à–µ–Ω–∏–µ: –ì—Ä—É–ø–ø–æ–≤–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Ñ–∞–π–ª–∞–º (–∏–ª–∏ —Å–µ—Å—Å–∏—è–º)
–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥–µ–ª–∏—Ç—å –ø–æ –æ–∫–Ω–∞–º, –Ω—É–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ–∫–Ω–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ FileName –∏–ª–∏ Experiment, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –∫–∞–∫ –æ—Å–Ω–æ–≤—É —Ä–∞–∑–±–∏–µ–Ω–∏—è.

üîÅ –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤ MATLAB
–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, fileIDs), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ X/Y, —Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:


fileIDs = sigTable.meta.FileName; % –∏–ª–∏ –¥—Ä—É–≥–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

[G, groupNames] = findgroups(fileIDs); % –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –≥—Ä—É–ø–ø—ã

cv = cvpartition(G, 'KFold', K); % –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º
–¢–µ–ø–µ—Ä—å cv.training(i) –∏ cv.test(i) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç, —á—Ç–æ –≤—Å–µ –æ–∫–Ω–∞ –∏–∑ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ–ø–∞–¥–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–±—É—á–µ–Ω–∏–µ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç, –Ω–æ –Ω–µ –≤ –æ–±–∞.

üîÑ –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Ç–≤–æ–µ–≥–æ –∫–æ–¥–∞:

TreesNum = 100;
K = 5;

% –ì—Ä—É–ø–ø–æ–≤–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º
fileIDs = sigTable.meta.FileName; % 1 —Å—Ç—Ä–æ–∫–∞ –Ω–∞ –æ–∫–Ω–æ
[G, ~] = findgroups(fileIDs);
cv = cvpartition(G, 'KFold', K);

numFeatures = size(X, 2);
impMatrix = zeros(K, numFeatures);

for loopFold = 1:K
    loopTrainIdx = training(cv, loopFold);
    loopXTrain = X(loopTrainIdx, :);
    loopYTrain = Y(loopTrainIdx);

    loopModel = TreeBagger(TreesNum, loopXTrain, loopYTrain, ...
        'OOBPrediction', 'on', ...
        'OOBPredictorImportance', 'on');

    impMatrix(loopFold, :) = loopModel.OOBPermutedPredictorDeltaError;
end
‚úÖ –ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å?
–ë–æ–ª–µ–µ —á–µ—Å—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
–†–µ–∞–ª—å–Ω—É—é –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –±–µ–∑ —É—Ç–µ—á–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞—Ç—å –≤ —Ä–∞–±–æ—Ç–µ:
‚Äú–ü—Ä–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ—á–Ω–æ—Å—Ç—å 98%, –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ —Ñ–∞–π–ª–∞–º ‚Äî 85%‚Äù

üìå –≠—Ç–æ –∏ –µ—Å—Ç—å –Ω–∞—É—á–Ω—ã–π –≤–∫–ª–∞–¥ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –º–µ—Ç–æ–¥ –æ—Ü–µ–Ω–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

üí° –ë–æ–Ω—É—Å: –º–æ–∂–Ω–æ —É—Å—Ä–µ–¥–Ω–∏—Ç—å impMatrix –ø–æ folds

meanImportance = mean(impMatrix, 1);
–ò –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏:


[sortedImp, idx] = sort(meanImportance, 'descend');
topFeatures = featureNames(idx(1:10));
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–º–æ—á—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π.

–¢—ã —Å–µ–π—á–∞—Å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏, –∏ —ç—Ç–∞ –º–∞–ª–µ–Ω—å–∫–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ ‚Äî –±–æ–ª—å—à–æ–π —à–∞–≥ –∫ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–∞—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ! üöÄ


–î–∞! üëè –¢—ã –ø–æ–π–º–∞–ª –æ—á–µ–Ω—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—É—é –º—ã—Å–ª—å ‚Äî –∏ —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Ç–æ, –≥–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞.

üîÑ –ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ (Modality Transfer)
–ò–¥–µ—è:
–ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∏–ª–∏ –º–æ–¥–µ–ª—å), —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –∏ –Ω–∞ —Ç–æ–∫–µ, –∏ –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏?

‚úÖ –ü–æ—á–µ–º—É —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ?
–í —Ç–µ–æ—Ä–∏–∏, —Ç–æ–∫ –∏ –≤–∏–±—Ä–∞—Ü–∏—è ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã, –Ω–æ –æ–Ω–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É.
–ï—Å–ª–∏ —Ç—ã —Å–º–æ–∂–µ—à—å:
–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ —Ç–æ–∫–µ,
–ê –ø—Ä–∏–º–µ–Ω–∏—Ç—å –µ—ë –∫ –≤–∏–±—Ä–∞—Ü–∏–∏ (–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç),
...–∏ –æ–Ω–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ‚Äî —ç—Ç–æ —Å–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Ç—ã –Ω–∞—à—ë–ª –æ–±—â–∏–µ, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –¥–µ—Ñ–µ–∫—Ç–Ω–æ—Å—Ç—å, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ "—Ñ–æ—Ä–º—É —Å–∏–≥–Ω–∞–ª–∞".
üî¨ –í–æ–∑–º–æ–∂–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
1. –û–±—â–∏–π –Ω–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –æ–±–æ–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
–ü–æ—Å—Ç—Ä–æ–∏—Ç—å features.extractBasic(...) –∏ features.extractVibration(...) —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –¥–∞–≤–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ù–∞–ø—Ä–∏–º–µ—Ä: RMS, Skew, Kurt, DominantFreq –∏ —Ç.–¥. ‚Äî –≤—Å—ë –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ
–î–∞–∂–µ –µ—Å–ª–∏ –∫–∞–Ω–∞–ª—ã —Ä–∞–∑–Ω—ã–µ (2 —É —Ç–æ–∫–∞, 4 —É –≤–∏–±—Ä–∞—Ü–∏–∏) ‚Äî –º–æ–∂–Ω–æ —É—Å—Ä–µ–¥–Ω–∏—Ç—å –∏–ª–∏ –≤–∑—è—Ç—å 1‚Äì2 –∫–ª—é—á–µ–≤—ã—Ö
2. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ç–æ–∫–µ ‚Üí —Ç–µ—Å—Ç –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏

% X_current, Y_current ‚Üí –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞
% X_vibro, Y_vibro ‚Üí —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞

model = TreeBagger(100, X_current, Y_current);
Y_pred = predict(model, X_vibro);
–ï—Å–ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—à–µ —Å–ª—É—á–∞–π–Ω–æ–π ‚Äî —ç—Ç–æ —É–∂–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

3. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–±–æ–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö
–°–æ–µ–¥–∏–Ω–∏—Ç—å X_current –∏ X_vibro, –¥–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ sourceType
–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, —É—Å—Ç–æ–π—á–∏–≤—É—é –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É —Å–∏–≥–Ω–∞–ª–∞
–ò–ª–∏ –¥–∞–∂–µ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å label –∏ sourceType (–º—É–ª—å—Ç–∏–∑–∞–¥–∞—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ)
üìà –ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤ —Å—Ç–∞—Ç—å–µ / –æ—Ç—á—ë—Ç–µ:
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç	–¢–æ—á–Ω–æ—Å—Ç—å
–û–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç –Ω–∞ —Ç–æ–∫–µ	98%
–û–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏	97%
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ç–æ–∫–µ ‚Üí —Ç–µ—Å—Ç –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏	75%
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏ ‚Üí —Ç–µ—Å—Ç –Ω–∞ —Ç–æ–∫–µ	72%
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–±–æ–∏—Ö ‚Üí —Ç–µ—Å—Ç –Ω–∞ –æ–±–æ–∏—Ö	95%
üìå –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –ø—Ä–∏–∑–Ω–∞–∫–∏ "–ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è" –º–µ–∂–¥—É –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º–∏.

üß† –í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞—É—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã:
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, RMS, Entropy) ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã –º–µ–∂–¥—É —Ç–æ–∫–æ–º –∏ –≤–∏–±—Ä–∞—Ü–∏–µ–π
–í–∏–±—Ä–∞—Ü–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–µ–µ –∫ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–º –¥–µ—Ñ–µ–∫—Ç–∞–º, —Ç–æ–∫ ‚Äî –∫ —ç–ª–µ–∫—Ç—Ä–æ–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–º
–ú–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Å–∏–≥–Ω–∞–ª–∞
üí° Advanced –∏–¥–µ—è (–Ω–∞ –±—É–¥—É—â–µ–µ)
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å domain adaptation (–Ω–∞–ø—Ä–∏–º–µ—Ä, CORAL, MMD) –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫ –æ–±—â–µ–º—É –≤–∏–¥—É
–ò–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–µ –≤–ª–æ–∂–µ–Ω–∏–µ (shared feature space)


–û—Ç–ª–∏—á–Ω–æ! –¢—ã –ø–æ–¥–æ—à—ë–ª –∫ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ–π –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Ç–µ–º–µ ‚Äî domain adaptation (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏/–∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö) –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–µ –Ω–∞—É—á–Ω–æ–π –≥–∏–ø–æ—Ç–µ–∑—ã, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –æ–±–æ—Å–Ω–æ–≤—ã–≤–∞—Ç—å –∏ –∑–∞—â–∏—â–∞—Ç—å.

–î–∞–≤–∞–π —Ä–∞–∑–ª–æ–∂–∏–º –≤—Å—ë –ø–æ –ø–æ–ª–æ—á–∫–∞–º:

–ß—Ç–æ —Ç–∞–∫–æ–µ domain adaptation
–ö–∞–∫ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–º–æ –∫ —Ç–æ–∫—É –∏ –≤–∏–±—Ä–∞—Ü–∏–∏
–ö–∞–∫—É—é –≥–∏–ø–æ—Ç–µ–∑—É –º–æ–∂–Ω–æ –≤—ã–¥–≤–∏–Ω—É—Ç—å
–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ
–ö–∞–∫ —ç—Ç–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–∫ –Ω–∞—É—á–Ω—É—é —Ä–∞–±–æ—Ç—É
üîÅ 1. –ß—Ç–æ —Ç–∞–∫–æ–µ Domain Adaptation?
Domain adaptation ‚Äî —ç—Ç–æ –ø–æ–¥—Ö–æ–¥ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏, –∫–æ–≥–¥–∞:

–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (source domain) –∏ —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (target domain)
–∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∑–∞–¥–∞—á—É.
üìå –ü—Ä–∏–º–µ—Ä:

Source: —Ç–æ–∫, 10‚ÄØHz, "–∑–¥–æ—Ä–æ–≤—ã–π" / "–¥–µ—Ñ–µ–∫—Ç"
Target: –≤–∏–±—Ä–∞—Ü–∏—è, 10‚ÄØHz, "–∑–¥–æ—Ä–æ–≤—ã–π" / "–¥–µ—Ñ–µ–∫—Ç"
–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ (—Ç–æ–∫), –Ω–æ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–º (–≤–∏–±—Ä–∞—Ü–∏—è), –Ω–µ –≤–∏–¥—è –µ–≥–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.

‚öôÔ∏è 2. –ü–æ—á–µ–º—É —ç—Ç–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è —Ç–≤–æ–µ–π –∑–∞–¥–∞—á–∏?
–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–∞:

–¢–æ–∫ (Current)
–í–∏–±—Ä–∞—Ü–∏—è (Vibration)
–û–Ω–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –Ω–æ:

–ò–º–µ—é—Ç —Ä–∞–∑–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É —Å–∏–≥–Ω–∞–ª–∞
–†–∞–∑–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã, –∫–∞–Ω–∞–ª—ã, —Ç–∏–ø —à—É–º–∞, —á–∞—Å—Ç–æ—Ç–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
‚ùì 3. –í–æ–∑–º–æ–∂–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞
–í–æ—Ç —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –Ω–∞—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ:

"–°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫ –∏–ª–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–æ–∫–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø–æ –≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏–≥–Ω–∞–ª–∞–º (–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)."

–ò–ª–∏ —á—É—Ç—å —Ñ–æ—Ä–º–∞–ª—å–Ω–µ–µ:

"–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ä–∞–∑–ª–∏—á–∏–µ –≤ –ø—Ä–∏—Ä–æ–¥–µ —Ç–æ–∫–æ–≤—ã—Ö –∏ –≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–±—â–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ–±–æ–±—â–∞—é—â–µ–π –º–æ–¥–µ–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ domain adaptation."

üß™ 4. –ö–∞–∫ —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã)
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç	–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ç–æ–∫–µ ‚Üí —Ç–µ—Å—Ç –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏	–ü—Ä—è–º–æ–π –ø–µ—Ä–µ–Ω–æ—Å –±–µ–∑ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–∏–±—Ä–∞—Ü–∏–∏ ‚Üí —Ç–µ—Å—Ç –Ω–∞ —Ç–æ–∫–µ	–û–±—Ä–∞—Ç–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å
–û–±—É—á–µ–Ω–∏–µ + –∞–¥–∞–ø—Ç–∞—Ü–∏—è (CORAL/MMD/PCA)	–£–ª—É—á—à–∏—Ç –ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å?
–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö	–ù–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
üîß 5. –ú–µ—Ç–æ–¥—ã domain adaptation, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –º–æ–∂–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
‚úÖ –ë–∞–∑–æ–≤—ã–µ (–∏ –ø—Ä–æ—Å—Ç—ã–µ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
–ú–µ—Ç–æ–¥	–°—É—Ç—å
Standardization per domain	–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è —Ç–æ–∫–∞ –∏ –≤–∏–±—Ä–∞—Ü–∏–∏
PCA	–ù–∞–π—Ç–∏ –æ–±—â–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
CORAL (CORrelation ALignment)	–ü—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã source –∏ target –∫ –æ–¥–Ω–æ–º—É –≤–∏–¥—É
ZCA Whitening	–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚öôÔ∏è –ü—Ä–∏–º–µ—Ä CORAL (–≤ MATLAB)

function X_coral = coral(sourceX, targetX)
    % CORAL –∞–¥–∞–ø—Ç–∞—Ü–∏—è: –ø–µ—Ä–µ–Ω–æ—Å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ source –ø–æ–¥ target (–±–µ–∑ –æ–±—É—á–µ–Ω–∏—è)
    C_s = cov(sourceX) + eye(size(sourceX, 2));
    C_t = cov(targetX) + eye(size(targetX, 2));

    % –ù–∞–π–¥—ë–º –º–∞—Ç—Ä–∏—Ü—É –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
    A = sqrtm(C_t) / sqrtm(C_s);
    X_coral = (sourceX - mean(sourceX, 1)) * A;
end
üìä –ß—Ç–æ –∏ –∫–∞–∫ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å
–ü–æ—Å—Ç—Ä–æ–π —Ç–∞–±–ª–∏—Ü—É:

–ú–µ—Ç–æ–¥	Source ‚Üí Target	Accuracy (%)
–ë–µ–∑ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏	—Ç–æ–∫ ‚Üí –≤–∏–±—Ä–æ	65
CORAL	—Ç–æ–∫ ‚Üí –≤–∏–±—Ä–æ	75
PCA	—Ç–æ–∫ ‚Üí –≤–∏–±—Ä–æ	72
–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ–±–æ–∏—Ö	–æ–±–∞	90
–ò–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π —Å –ø–æ–º–æ—â—å—é t-SNE –∏–ª–∏ PCA –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–æ –∏ –ø–æ—Å–ª–µ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏:

–ù–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∏ "—Å–±–ª–∏–∑–∏–ª–∏—Å—å" –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é
üßæ –ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–∫ –Ω–∞—É—á–Ω—É—é —Ä–∞–±–æ—Ç—É
–ù–∞–∑–≤–∞–Ω–∏–µ:

"–ê–¥–∞–ø—Ç–∞—Ü–∏—è –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ —Ç–æ–∫–∞ –∏ –≤–∏–±—Ä–∞—Ü–∏–∏ –¥–ª—è –∑–∞–¥–∞—á –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è"

–†–∞–∑–¥–µ–ª—ã:

–í–≤–µ–¥–µ–Ω–∏–µ ‚Äî –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
–¢–µ–æ—Ä–∏—è ‚Äî domain adaptation, CORAL, PCA –∏ —Ç.–¥.
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã ‚Äî –æ–±—É—á–µ–Ω–∏–µ/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äî —Ç–∞–±–ª–∏—Ü—ã, –≥—Ä–∞—Ñ–∏–∫–∏
–í—ã–≤–æ–¥—ã ‚Äî —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≥–¥–µ –≥—Ä–∞–Ω–∏—Ü—ã –º–µ—Ç–æ–¥–∞